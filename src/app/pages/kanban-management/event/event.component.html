<section class="container-fluid p-4">
  <div class="row">
    <div class="col-lg-12 col-md-12 col-12">
      <!-- Page header -->
      <div>
        <div class="border-bottom pb-3 mb-3">
          <h2 class="mb-0 fw-bold">Events</h2>
        </div>
      </div>
    </div>
  </div>
  <!-- Select Project Dropdown -->
  <div class="form-control">
    <div class="row">
      <div class="col-md-6 mb-3">
        <!-- Select Project Dropdown -->
        <label for="projectSelect" class="form-label">Project:</label>
        <select
          id="projectSelect"
          class="form-select text-inherit fw-bold"
          [ngModelOptions]="{ standalone: true }"
          [(ngModel)]="selectedProject"
          (change)="onProjectChange()"
        >
          <option class="text-primary" [value]="null">Select Project</option>
          <option
            *ngFor="let project of projects"
            [ngValue]="project"
            [selected]="project.projectId === selectedProject?.projectId"
            class="text-primary"
          >
            {{ project.name }}
          </option>
        </select>
      </div>
      <div class="col-md-6 mb-3" *ngIf="selectedProject && showEvents">
        <label class="text-inherit fw-bold mb-0 h3">
          <i class="mdi mdi-console fs-3"></i>
          {{ this.selectedProject.name }}
        </label>
      </div>
    </div>
  </div>
  <br />
  <div *ngIf="!showEvents">
    <div class="d-flex justify-content-center align-items-center h-100">
      <div class="text-center">
        <h2 class="form-label">
          Select a project or ask to join a team to get started.
        </h2>

        <img
          src="../assets/images/background/comingsoon.svg"
          alt="maintenance"
          class="w-100"
        />
      </div>
    </div>
  </div>
  <div *ngIf="showEvents && selectedProject">
    <div class="row justify-content-md-between mb-4 mb-xl-0">
      <!-- col -->
      <div class="col-xl-3 col-lg-4 col-md-6 col-12 mb-2 mb-lg-4">
        <!-- search -->
        <div class="mb-lg-4 mb-2">
          <input
            type="search"
            class="form-control"
            placeholder="Search events..."
          />
        </div>
        <button class="btn btn-xs btn-secondary">Clear Filter</button>
      </div>
    </div>
    <h3 class="mb-0 fw-bold">Teams :</h3>
    <div class="row" *ngFor="let team of selectedProject.teams">
      <h2 class="text-inherit fw-bold">
        <i class="mdi mdi-cube-outline me-2"> </i> {{ team.name }}
      </h2>
      <div
        class="col-xxl-3 col-xl-4 col-lg-6 col-12 mb-4"
        *ngFor="let event of team.events"
      >
        <!-- card -->
        <div class="card h-100">
          <div class="d-flex position-absolute end-0 pe-3 pt-3">
            <div class="dropdown dropstart">
              <a
                href="#"
                class="btn-icon btn btn-ghost btn-sm rounded-circle"
                id="dropdownProjectTen"
                data-bs-toggle="dropdown"
                aria-haspopup="true"
                aria-expanded="false"
              >
                <i class="bi bi-three-dots-vertical"></i>
              </a>
              <div class="dropdown-menu" aria-labelledby="dropdownProjectTen">
                <span class="dropdown-header">Settings</span>
                <a
                  class="dropdown-item"
                  (click)="openAddEditEventForm(event, team.teamId)"
                  style="cursor: pointer"
                  class="dropdown-item"
                >
                  <i class="fe fe-edit dropdown-item-icon"></i>Edit Details
                </a>
                <a
                  class="dropdown-item d-flex align-items-center"
                  (click)="onViewDetails(event)"
                  style="cursor: pointer"
                >
                  <i class="dropdown-item-icon fe fe-eye"></i>View Details
                </a>
                <a
                  class="dropdown-item"
                  *ngIf="event.eventId"
                  (click)="deleteEvent(event.eventId)"
                  style="cursor: pointer"
                >
                  <i class="fe fe-trash dropdown-item-icon"></i>Delete Event
                </a>
              </div>
            </div>
          </div>
          <!-- card body -->
          <div class="card-body">
            <!-- heading-->

            <!-- text-->

            <div class="mb-4">
              <h4 class="mb-0">
                <a class="text-inherit h3 text-primary" style="cursor: pointer"
                  ><i class="mdi mdi-cube-outline me-2"> </i>
                  {{ event.name }}</a
                >
              </h4>
            </div>
            <!-- progress -->
            <div
              class="d-flex justify-content-between align-items-lg-start mt-4"
            >
              <div class="form-control">
                <!-- task description -->
                <p class="event-description">
                  {{ event.description }}
                </p>
              </div>
            </div>
            <br />
          </div>
          <!-- card footer -->
          <div class="card-footer p-0">
            <div class="d-flex justify-content-between">
              <div class="w-50 py-3 px-4">
                <h6 class="mb-0 text-muted">Start Date:</h6>
                <p class="text-dark fs-6 fw-semibold mb-0">
                  {{ event.startDate | date : "short" }}
                </p>
              </div>
              <div class="border-start w-50 py-3 px-4">
                <h6 class="mb-0 text-muted">End Date:</h6>
                <p class="text-dark fs-6 fw-semibold mb-0">
                  {{ event.endDate | date : "short" }}
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="col-xxl-3 col-xl-4 col-lg-6 col-12 mb-4">
        <a
          (click)="openAddEditEventForm(undefined, team.teamId)"
          style="cursor: pointer"
        >
          <div
            class="card h-100 border border-2 shadow-none card-dashed-hover p-12"
          >
            <div
              class="card-body d-flex flex-column justify-content-center text-center"
            >
              <i
                class="fe fe-plus text-secondary mb-3 fs-2"
                aria-hidden="true"
              ></i>
            </div>
          </div>
        </a>
      </div>
    </div>
  </div>
</section>
